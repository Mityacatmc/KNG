{"ast":null,"code":"import { _ as _object_spread } from \"@swc/helpers/_/_object_spread\";\nimport { _ as _object_spread_props } from \"@swc/helpers/_/_object_spread_props\";\nimport { _ as _object_without_properties } from \"@swc/helpers/_/_object_without_properties\";\nimport { _ as _sliced_to_array } from \"@swc/helpers/_/_sliced_to_array\";\nimport * as React from \"react\";\nimport { classNames } from \"@vkontakte/vkjs\";\nimport { useExternRef } from \"../../hooks/useExternRef\";\nimport { RootComponent } from \"../RootComponent/RootComponent\";\nimport { ImageBaseBadge } from \"./ImageBaseBadge/ImageBaseBadge\";\nimport { ImageBaseOverlay } from \"./ImageBaseOverlay/ImageBaseOverlay\";\nimport { ImageBaseContext } from \"./context\";\nimport { validateFallbackIcon, validateSize } from \"./validators\";\nexport { getBadgeIconSizeByImageBaseSize, getFallbackIconSizeByImageBaseSize, getOverlayIconSizeByImageBaseSize } from \"./helpers\";\nexport { ImageBaseContext };\n/**\n * @see https://vkcom.github.io/VKUI/#/ImageBase\n */\n\nexport var ImageBase = function ImageBase(_param) {\n  var alt = _param.alt,\n      crossOrigin = _param.crossOrigin,\n      decoding = _param.decoding,\n      loading = _param.loading,\n      referrerPolicy = _param.referrerPolicy,\n      sizes = _param.sizes,\n      src = _param.src,\n      srcSet = _param.srcSet,\n      useMap = _param.useMap,\n      getRef = _param.getRef,\n      _param_size = _param.size,\n      size = _param_size === void 0 ? 24 : _param_size,\n      width = _param.width,\n      height = _param.height,\n      style = _param.style,\n      _param_withBorder = _param.withBorder,\n      withBorder = _param_withBorder === void 0 ? true : _param_withBorder,\n      fallbackIconProp = _param[\"fallbackIcon\"],\n      children = _param.children,\n      ariaLabel = _param[\"aria-label\"],\n      onClick = _param.onClick,\n      onLoad = _param.onLoad,\n      onError = _param.onError,\n      restProps = _object_without_properties(_param, [\"alt\", \"crossOrigin\", \"decoding\", \"loading\", \"referrerPolicy\", \"sizes\", \"src\", \"srcSet\", \"useMap\", \"getRef\", \"size\", \"width\", \"height\", \"style\", \"withBorder\", \"fallbackIcon\", \"children\", \"aria-label\", \"onClick\", \"onLoad\", \"onError\"]);\n\n  var _React_useState = _sliced_to_array(React.useState(false), 2),\n      loaded = _React_useState[0],\n      setLoaded = _React_useState[1];\n\n  var _React_useState1 = _sliced_to_array(React.useState(false), 2),\n      failed = _React_useState1[0],\n      setFailed = _React_useState1[1];\n\n  var hasSrc = src || srcSet;\n  var needShowFallbackIcon = (failed || !hasSrc) && /*#__PURE__*/React.isValidElement(fallbackIconProp);\n  var fallbackIcon = needShowFallbackIcon ? fallbackIconProp : null;\n\n  if (process.env.NODE_ENV === \"development\") {\n    validateSize(size);\n\n    if (fallbackIcon) {\n      validateFallbackIcon(size, {\n        name: \"fallbackIcon\",\n        value: fallbackIcon\n      });\n    }\n  }\n\n  var handleImageLoad = function handleImageLoad(event) {\n    var _onLoad;\n\n    if (loaded) {\n      return;\n    }\n\n    setLoaded(true);\n    setFailed(false);\n    (_onLoad = onLoad) === null || _onLoad === void 0 ? void 0 : _onLoad(event);\n  };\n\n  var handleImageError = function handleImageError(event) {\n    var _onError;\n\n    setLoaded(false);\n    setFailed(true);\n    (_onError = onError) === null || _onError === void 0 ? void 0 : _onError(event);\n  };\n\n  var imgRef = useExternRef(getRef);\n  var isOnLoadStatusCheckedRef = React.useRef(false);\n  React.useEffect(function dispatchLoadEventForAlreadyLoadedResourceIfReactInitializedLater() {\n    if (isOnLoadStatusCheckedRef.current) {\n      return;\n    }\n\n    isOnLoadStatusCheckedRef.current = true;\n\n    if (imgRef.current && imgRef.current.complete && !loaded) {\n      var event = new Event(\"load\");\n      imgRef.current.dispatchEvent(event);\n    }\n  }, [imgRef, loaded]);\n\n  var sizeClassName = function () {\n    switch (size) {\n      case 28:\n        return \"vkuiImageBase--size-28\";\n\n      case 32:\n        return \"vkuiImageBase--size-32\";\n\n      case 40:\n        return \"vkuiImageBase--size-40\";\n\n      case 48:\n        return \"vkuiImageBase--size-48\";\n\n      case 72:\n        return \"vkuiImageBase--size-72\";\n    }\n\n    return null;\n  }();\n\n  return /*#__PURE__*/React.createElement(ImageBaseContext.Provider, {\n    value: {\n      size: size\n    }\n  }, /*#__PURE__*/React.createElement(RootComponent, _object_spread_props(_object_spread({}, restProps), {\n    style: _object_spread_props(_object_spread({}, style), {\n      width: size,\n      height: size\n    }),\n    baseClassName: classNames(\"vkuiImageBase\", sizeClassName, loaded && \"vkuiImageBase--loaded\"),\n    role: hasSrc ? \"img\" : \"presentation\",\n    \"aria-label\": ariaLabel,\n    onClick: onClick\n  }), hasSrc && /*#__PURE__*/React.createElement(\"img\", {\n    ref: imgRef,\n    alt: alt,\n    className: \"vkuiImageBase__img\",\n    crossOrigin: crossOrigin,\n    decoding: decoding,\n    loading: loading,\n    referrerPolicy: referrerPolicy,\n    sizes: sizes,\n    src: src,\n    srcSet: srcSet,\n    useMap: useMap,\n    width: width,\n    height: height,\n    onLoad: handleImageLoad,\n    onError: handleImageError\n  }), fallbackIcon && /*#__PURE__*/React.createElement(\"div\", {\n    className: \"vkuiImageBase__fallback\"\n  }, fallbackIcon), children, withBorder && /*#__PURE__*/React.createElement(\"div\", {\n    \"aria-hidden\": true,\n    className: \"vkuiImageBase__border\"\n  })));\n};\nImageBase.Badge = ImageBaseBadge;\nImageBase.Overlay = ImageBaseOverlay;","map":{"version":3,"mappings":"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","names":["React","classNames","useExternRef","RootComponent","ImageBaseBadge","ImageBaseOverlay","ImageBaseContext","validateFallbackIcon","validateSize","getBadgeIconSizeByImageBaseSize","getFallbackIconSizeByImageBaseSize","getOverlayIconSizeByImageBaseSize","ImageBase","alt","crossOrigin","decoding","loading","referrerPolicy","sizes","src","srcSet","useMap","getRef","size","_param_size","width","height","style","withBorder","_param_withBorder","fallbackIconProp","children","ariaLabel","onClick","onLoad","onError","restProps","useState","loaded","setLoaded","failed","setFailed","hasSrc","needShowFallbackIcon","isValidElement","fallbackIcon","process","env","NODE_ENV","name","value","handleImageLoad","event","handleImageError","imgRef","isOnLoadStatusCheckedRef","useRef","useEffect","dispatchLoadEventForAlreadyLoadedResourceIfReactInitializedLater","current","complete","Event","dispatchEvent","sizeClassName","Provider","_object_spread_props","baseClassName","role","aria-label","img","ref","className","div","aria-hidden","Badge","Overlay"],"sources":["C:\\Users\\Я\\Desktop\\myproject\\vk-miniapps\\Koto-app\\node_modules\\@vkontakte\\vkui\\src\\components\\ImageBase\\ImageBase.tsx"],"sourcesContent":["import * as React from 'react';\nimport { classNames } from '@vkontakte/vkjs';\nimport { useExternRef } from '../../hooks/useExternRef';\nimport type { HasRef, HasRootRef, LiteralUnion } from '../../types';\nimport { RootComponent } from '../RootComponent/RootComponent';\nimport { ImageBaseBadge, type ImageBaseBadgeProps } from './ImageBaseBadge/ImageBaseBadge';\nimport { ImageBaseOverlay, type ImageBaseOverlayProps } from './ImageBaseOverlay/ImageBaseOverlay';\nimport { ImageBaseContext } from './context';\nimport type { ImageBaseContextProps, ImageBaseExpectedIconProps, ImageBaseSize } from './types';\nimport { validateFallbackIcon, validateSize } from './validators';\nimport styles from './ImageBase.module.css';\n\nexport type {\n  ImageBaseSize,\n  ImageBaseExpectedIconProps,\n  ImageBaseBadgeProps,\n  ImageBaseOverlayProps,\n  ImageBaseContextProps,\n};\n\nexport {\n  getBadgeIconSizeByImageBaseSize,\n  getFallbackIconSizeByImageBaseSize,\n  getOverlayIconSizeByImageBaseSize,\n} from './helpers';\n\nexport { ImageBaseContext };\n\nexport interface ImageBaseProps\n  extends React.ImgHTMLAttributes<HTMLElement>,\n    HasRootRef<HTMLDivElement>,\n    HasRef<HTMLImageElement> {\n  /**\n   * Задаёт размер картинки.\n   *\n   * Используйте размеры заданные дизайн-системой `16 | 20 | 24 | 28 | 32 | 36 | 40 | 44 | 48 | 56 | 64 | 72 | 80 | 88 | 96`.\n   *\n   * > ⚠️ Использование кастомного размера – это пограничный кейс.\n   */\n  size?: LiteralUnion<ImageBaseSize, number>;\n  /**\n   * Включает или отключает обводку.\n   */\n  withBorder?: boolean;\n  /**\n   * Фолбек на случай, если картинка не прогрузилась.\n   *\n   * > 📝 Нужный для `<ImageBase size={...} />` размер можно узнать из функции `getFallbackIconSizeByImageBaseSize()`.\n   *\n   * > Предпочтительней использовать иконки из `@vkontakte/icons`.\n   *\n   * > 📊️ Если вы хотите передать кастомную иконку, то следует именовать её по шаблону `Icon<size><name>`. Или же\n   * > чтобы в неё был передан параметр `width`. Тогда мы сможем выводить в консоль подсказку правильного ли размера вы\n   * > использовали иконку.\n   *\n   * > ⚠️ Может перекрывать `children`.\n   */\n  fallbackIcon?: React.ReactElement<ImageBaseExpectedIconProps>;\n}\n\n/**\n * @see https://vkcom.github.io/VKUI/#/ImageBase\n */\nexport const ImageBase = ({\n  alt,\n  crossOrigin,\n  decoding,\n  loading,\n  referrerPolicy,\n  sizes,\n  src,\n  srcSet,\n  useMap,\n  getRef,\n  size = 24,\n  width,\n  height,\n  style,\n  withBorder = true,\n  'fallbackIcon': fallbackIconProp,\n  children,\n  'aria-label': ariaLabel,\n  onClick,\n  onLoad,\n  onError,\n  ...restProps\n}: ImageBaseProps) => {\n  const [loaded, setLoaded] = React.useState(false);\n  const [failed, setFailed] = React.useState(false);\n\n  const hasSrc = src || srcSet;\n  const needShowFallbackIcon = (failed || !hasSrc) && React.isValidElement(fallbackIconProp);\n\n  const fallbackIcon = needShowFallbackIcon ? fallbackIconProp : null;\n\n  if (process.env.NODE_ENV === 'development') {\n    validateSize(size);\n    if (fallbackIcon) {\n      validateFallbackIcon(size, { name: 'fallbackIcon', value: fallbackIcon });\n    }\n  }\n\n  const handleImageLoad = (event: React.SyntheticEvent<HTMLImageElement>) => {\n    if (loaded) {\n      return;\n    }\n\n    setLoaded(true);\n    setFailed(false);\n    onLoad?.(event);\n  };\n\n  const handleImageError = (event: React.SyntheticEvent<HTMLImageElement>) => {\n    setLoaded(false);\n    setFailed(true);\n    onError?.(event);\n  };\n\n  const imgRef = useExternRef(getRef);\n  const isOnLoadStatusCheckedRef = React.useRef(false);\n  React.useEffect(\n    function dispatchLoadEventForAlreadyLoadedResourceIfReactInitializedLater() {\n      if (isOnLoadStatusCheckedRef.current) {\n        return;\n      }\n      isOnLoadStatusCheckedRef.current = true;\n\n      if (imgRef.current && imgRef.current.complete && !loaded) {\n        const event = new Event('load');\n        imgRef.current.dispatchEvent(event);\n      }\n    },\n    [imgRef, loaded],\n  );\n\n  const sizeClassName = (() => {\n    switch (size) {\n      case 28:\n        return styles['ImageBase--size-28'];\n      case 32:\n        return styles['ImageBase--size-32'];\n      case 40:\n        return styles['ImageBase--size-40'];\n      case 48:\n        return styles['ImageBase--size-48'];\n      case 72:\n        return styles['ImageBase--size-72'];\n    }\n\n    return null;\n  })();\n\n  return (\n    <ImageBaseContext.Provider value={{ size }}>\n      <RootComponent\n        {...restProps}\n        style={{ ...style, width: size, height: size }}\n        baseClassName={classNames(\n          styles['ImageBase'],\n          sizeClassName,\n          loaded && styles['ImageBase--loaded'],\n        )}\n        role={hasSrc ? 'img' : 'presentation'}\n        aria-label={ariaLabel}\n        onClick={onClick}\n      >\n        {hasSrc && (\n          <img\n            ref={imgRef}\n            alt={alt}\n            className={styles['ImageBase__img']}\n            crossOrigin={crossOrigin}\n            decoding={decoding}\n            loading={loading}\n            referrerPolicy={referrerPolicy}\n            sizes={sizes}\n            src={src}\n            srcSet={srcSet}\n            useMap={useMap}\n            width={width}\n            height={height}\n            onLoad={handleImageLoad}\n            onError={handleImageError}\n          />\n        )}\n        {fallbackIcon && <div className={styles['ImageBase__fallback']}>{fallbackIcon}</div>}\n        {children}\n        {withBorder && <div aria-hidden className={styles['ImageBase__border']} />}\n      </RootComponent>\n    </ImageBaseContext.Provider>\n  );\n};\n\nImageBase.Badge = ImageBaseBadge;\n\nImageBase.Overlay = ImageBaseOverlay;\n"]},"metadata":{},"sourceType":"module"}