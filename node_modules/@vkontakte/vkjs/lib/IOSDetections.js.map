{"version":3,"sources":["../src/IOSDetections.ts"],"sourcesContent":["import { canUseDOM } from './dom';\n\nexport const IPHONE_SAFARI_BOTTOM_BAR = 45;\nexport const IPHONE_X_SAFARI_BOTTOM_BAR = 85;\n\nexport const IPHONE_KEYBOARD_REJECT_OFFSET = 180;\n\n// 44 iPhone, 55 iPad, iPad Pro 69\nexport const IOS_NO_KEYBOARD_ALLOWED_OFFSET = 70;\n\nexport function detectIOS(ua?: string) {\n  if (!ua) {\n    ua = canUseDOM ? navigator.userAgent : '';\n  }\n  ua = ua.toLowerCase();\n\n  const isIPadOS = checkIPadOS(ua);\n  const isIPad = isIPadOS || ua.includes('ipad');\n  const isIPhone = !isIPad && ua.search(/iphone|ipod/) !== -1;\n  const isIOS = isIPhone || isIPad;\n\n  let iosVersion: string[] | typeof isIOS | ReturnType<typeof String.prototype.match> =\n    isIOS && ua.match(/os ([\\d_]+) like mac os x/i);\n  let iosMajor = 0;\n  let iosMinor = 0;\n\n  if (isIPadOS) {\n    iosMajor = 13;\n    iosMinor = 0;\n  } else if (iosVersion) {\n    iosVersion = iosVersion[1].split('_');\n    iosMajor = +iosVersion[0];\n    iosMinor = +iosVersion[1];\n  }\n\n  iosVersion = null;\n\n  const isScrollBasedViewport = iosMajor < 13 && !(iosMajor === 11 && iosMinor < 3);\n  const isWKWebView = isIOS && checkWKWebView(ua);\n\n  let isIPhoneX = false;\n\n  if (canUseDOM) {\n    isIPhoneX =\n      isIOS && screen.width === 375 && screen.height === 812 && window.devicePixelRatio === 3;\n  }\n\n  const isIOSChrome = ua.search(/crios/i) !== -1;\n\n  return {\n    isIPad,\n    isIPhone,\n    isIOS,\n    isIPadOS,\n    iosMajor,\n    iosMinor,\n    isWKWebView,\n    isScrollBasedViewport,\n    isIPhoneX,\n    isIOSChrome,\n  };\n}\n\nconst detect = /*#__PURE__*/ detectIOS();\n\nexport const isIPad = /*#__PURE__*/ (() => detect.isIPad)();\nexport const isIPhone = /*#__PURE__*/ (() => detect.isIPhone)();\nexport const isIOS = /*#__PURE__*/ (() => detect.isIOS)();\nexport const isIPadOS = /*#__PURE__*/ (() => detect.isIPadOS)();\nexport const iosMajor = /*#__PURE__*/ (() => detect.iosMajor)();\nexport const iosMinor = /*#__PURE__*/ (() => detect.iosMinor)();\nexport const isWKWebView = /*#__PURE__*/ (() => detect.isWKWebView)();\nexport const isScrollBasedViewport = /*#__PURE__*/ (() => detect.isScrollBasedViewport)();\nexport const isIPhoneX = /*#__PURE__*/ (() => detect.isIPhoneX)();\nexport const isIOSChrome = /*#__PURE__*/ (() => detect.isIOSChrome)();\n\nexport function isLandscapePhone() {\n  return Math.abs(window.orientation) === 90 && !isIPad;\n}\n\n// Reference:\n// https://stackoverflow.com/questions/28795476/detect-if-page-is-loaded-inside-wkwebview-in-javascript/30495399#30495399\nfunction checkWKWebView(ua: string) {\n  if (!canUseDOM) {\n    return false;\n  }\n\n  const webkit = (window as any).webkit;\n\n  if (webkit && webkit.messageHandlers) {\n    return true;\n  }\n\n  const lte9 = /constructor/i.test(String(window.HTMLElement));\n  const idb = !!window.indexedDB;\n\n  if (ua.includes('safari') && ua.includes('version') && !(navigator as any).standalone) {\n    // Safari (WKWebView/Nitro since 6+)\n  } else if ((!idb && lte9) || !(window.statusbar && window.statusbar.visible)) {\n    // UIWebView\n  } else if (!lte9 || idb) {\n    // WKWebView\n    return true;\n  }\n\n  return false;\n}\n\nexport function checkIPadOS(ua: string) {\n  if (!canUseDOM) {\n    return false;\n  }\n\n  const notIOS = !/ipad|iphone|ipod/.test(ua);\n  const macOS = ua.includes('mac os');\n\n  if (macOS && notIOS && typeof (navigator as any).standalone === 'boolean') {\n    return true;\n  }\n\n  return false;\n}\n"],"names":["IPHONE_SAFARI_BOTTOM_BAR","IPHONE_X_SAFARI_BOTTOM_BAR","IPHONE_KEYBOARD_REJECT_OFFSET","IOS_NO_KEYBOARD_ALLOWED_OFFSET","detectIOS","isIPad","isIPhone","isIOS","isIPadOS","iosMajor","iosMinor","isWKWebView","isScrollBasedViewport","isIPhoneX","isIOSChrome","isLandscapePhone","checkIPadOS","ua","canUseDOM","navigator","userAgent","toLowerCase","includes","search","iosVersion","match","split","checkWKWebView","screen","width","height","window","devicePixelRatio","detect","Math","abs","orientation","webkit","messageHandlers","lte9","test","String","HTMLElement","idb","indexedDB","standalone","statusbar","visible","notIOS","macOS"],"mappings":";;;;;;;;;;;IAEaA,wBAAwB;eAAxBA;;IACAC,0BAA0B;eAA1BA;;IAEAC,6BAA6B;eAA7BA;;IAGAC,8BAA8B;eAA9BA;;IAEGC,SAAS;eAATA;;IAuDHC,MAAM;eAANA;;IACAC,QAAQ;eAARA;;IACAC,KAAK;eAALA;;IACAC,QAAQ;eAARA;;IACAC,QAAQ;eAARA;;IACAC,QAAQ;eAARA;;IACAC,WAAW;eAAXA;;IACAC,qBAAqB;eAArBA;;IACAC,SAAS;eAATA;;IACAC,WAAW;eAAXA;;IAEGC,gBAAgB;eAAhBA;;IAgCAC,WAAW;eAAXA;;;mBA5GU;AAEnB,IAAMhB,2BAA2B;AACjC,IAAMC,6BAA6B;AAEnC,IAAMC,gCAAgC;AAE7C,kCAAkC;AAC3B,IAAMC,iCAAiC;AAEvC,SAASC,UAAUa,EAAW;IACnC,IAAI,CAACA,IAAI;QACPA,KAAKC,cAAS,GAAGC,UAAUC,SAAS,GAAG;IACzC;IACAH,KAAKA,GAAGI,WAAW;IAEnB,IAAMb,WAAWQ,YAAYC;IAC7B,IAAMZ,SAASG,YAAYS,GAAGK,QAAQ,CAAC;IACvC,IAAMhB,WAAW,CAACD,UAAUY,GAAGM,MAAM,CAAC,mBAAmB,CAAC;IAC1D,IAAMhB,QAAQD,YAAYD;IAE1B,IAAImB,aACFjB,SAASU,GAAGQ,KAAK,CAAC;IACpB,IAAIhB,WAAW;IACf,IAAIC,WAAW;IAEf,IAAIF,UAAU;QACZC,WAAW;QACXC,WAAW;IACb,OAAO,IAAIc,YAAY;QACrBA,aAAaA,UAAU,CAAC,EAAE,CAACE,KAAK,CAAC;QACjCjB,WAAW,CAACe,UAAU,CAAC,EAAE;QACzBd,WAAW,CAACc,UAAU,CAAC,EAAE;IAC3B;IAEAA,aAAa;IAEb,IAAMZ,wBAAwBH,WAAW,MAAM,CAAEA,CAAAA,aAAa,MAAMC,WAAW,CAAA;IAC/E,IAAMC,cAAcJ,SAASoB,eAAeV;IAE5C,IAAIJ,YAAY;IAEhB,IAAIK,cAAS,EAAE;QACbL,YACEN,SAASqB,OAAOC,KAAK,KAAK,OAAOD,OAAOE,MAAM,KAAK,OAAOC,OAAOC,gBAAgB,KAAK;IAC1F;IAEA,IAAMlB,cAAcG,GAAGM,MAAM,CAAC,cAAc,CAAC;IAE7C,OAAO;QACLlB,QAAAA;QACAC,UAAAA;QACAC,OAAAA;QACAC,UAAAA;QACAC,UAAAA;QACAC,UAAAA;QACAC,aAAAA;QACAC,uBAAAA;QACAC,WAAAA;QACAC,aAAAA;IACF;AACF;AAEA,IAAMmB,SAAS,WAAW,GAAG7B;AAEtB,IAAMC,SAAuB,AAAd,WAAW,GAAI;WAAM4B,OAAO5B,MAAM;;AACjD,IAAMC,WAAyB,AAAd,WAAW,GAAI;WAAM2B,OAAO3B,QAAQ;;AACrD,IAAMC,QAAsB,AAAd,WAAW,GAAI;WAAM0B,OAAO1B,KAAK;;AAC/C,IAAMC,WAAyB,AAAd,WAAW,GAAI;WAAMyB,OAAOzB,QAAQ;;AACrD,IAAMC,WAAyB,AAAd,WAAW,GAAI;WAAMwB,OAAOxB,QAAQ;;AACrD,IAAMC,WAAyB,AAAd,WAAW,GAAI;WAAMuB,OAAOvB,QAAQ;;AACrD,IAAMC,cAA4B,AAAd,WAAW,GAAI;WAAMsB,OAAOtB,WAAW;;AAC3D,IAAMC,wBAAsC,AAAd,WAAW,GAAI;WAAMqB,OAAOrB,qBAAqB;;AAC/E,IAAMC,YAA0B,AAAd,WAAW,GAAI;WAAMoB,OAAOpB,SAAS;;AACvD,IAAMC,cAA4B,AAAd,WAAW,GAAI;WAAMmB,OAAOnB,WAAW;;AAE3D,SAASC;IACd,OAAOmB,KAAKC,GAAG,CAACJ,OAAOK,WAAW,MAAM,MAAM,CAAC/B;AACjD;AAEA,aAAa;AACb,yHAAyH;AACzH,SAASsB,eAAeV,EAAU;IAChC,IAAI,CAACC,cAAS,EAAE;QACd,OAAO;IACT;IAEA,IAAMmB,SAAS,AAACN,OAAeM,MAAM;IAErC,IAAIA,UAAUA,OAAOC,eAAe,EAAE;QACpC,OAAO;IACT;IAEA,IAAMC,OAAO,eAAeC,IAAI,CAACC,OAAOV,OAAOW,WAAW;IAC1D,IAAMC,MAAM,CAAC,CAACZ,OAAOa,SAAS;IAE9B,IAAI3B,GAAGK,QAAQ,CAAC,aAAaL,GAAGK,QAAQ,CAAC,cAAc,CAAC,AAACH,UAAkB0B,UAAU,EAAE,CAEvF,OADE,oCAAoC;IAC/B,IAAI,AAAC,CAACF,OAAOJ,QAAS,CAAER,CAAAA,OAAOe,SAAS,IAAIf,OAAOe,SAAS,CAACC,OAAO,AAAD,GAAI,CAE9E,OADE,YAAY;IACP,IAAI,CAACR,QAAQI,KAAK;QACvB,YAAY;QACZ,OAAO;IACT;IAEA,OAAO;AACT;AAEO,SAAS3B,YAAYC,EAAU;IACpC,IAAI,CAACC,cAAS,EAAE;QACd,OAAO;IACT;IAEA,IAAM8B,SAAS,CAAC,mBAAmBR,IAAI,CAACvB;IACxC,IAAMgC,QAAQhC,GAAGK,QAAQ,CAAC;IAE1B,IAAI2B,SAASD,UAAU,OAAO,AAAC7B,UAAkB0B,UAAU,KAAK,WAAW;QACzE,OAAO;IACT;IAEA,OAAO;AACT"}